总体上原神的角色渲染的光照构成是：兰伯特漫反射 + BlinnPhong高光 + 自发光  
卡通渲染主要通过光照分层、区域细分、形状控制等 来体现角色的各种细节 增加识别度
卡通渲染光照体系可以参考Unity日本的UnityChan项目：
    UnityChan：https://github.com/unity3d-jp/UnityChanToonShaderVer2_Project
由于卡通渲染广泛应用于VTuber 也可以参考一下这方面的应用
    MToon：https://github.com/Miraikomachi/MiraikomachiUnity
由于原神的研究者众多 也可以参考知乎文章
    原神角色渲染：https://zhuanlan.zhihu.com/p/468209534

自影与投影：SelfShaow && CastShadow
    角色不接受自身的投影，仅接受自影和大型建筑投影。
    自影：基于兰伯特漫反射系数NotL重映射 将表面分成正常区和阴影区
    投影：基于碰撞盒遮挡关系判断角色是否在投影下
isInSelfShadow ：是否在自影下
isInCoverShadow ：是否在投影下
isInAnyShadow ：是否在任何阴影下

昼夜变化：为了配合环境昼夜变化 提供了冷色调 跟随场景光源明暗变化
isInNight ：是否在夜晚

贴图通道解释：
    _BaseMap：RGB是Albedo A是可选的遮罩
        可通过材质属性控制A通道的用途 如：裁剪透明度、自发光遮罩、脸红遮罩
        裁剪：用于镂空效果
        自发光：比如琴腰间的玉佩会间歇性发光
        脸红遮罩：可用于制作表情动画
    _LightMap：R是高光强度遮罩  G是衰减遮罩  B是高光范围遮罩  A是材质类型     
        R: 直接作为高光部分的系数 比如金属区域是1 皮革部分是0.5 其他部分是0
        B: 高光因子低于阀值时高光值为0 比如盔甲的折痕处 与NdotL互动
            R和B通道表达的遮罩概念上不冲突 A描述材质 B描述表面结构
        G：和NdotL实时反映的明暗衰减不同 G通道是手绘的固定衰减遮罩
            1的区域永远不在自影下 0的区域永远在自影下
            中间区域越暗越容易产生自影 与NdotL和自影阀值互动决定明暗分界线
        A：材质类型遮罩 不同类型的材质给与不同的漫反射和高光表现
            材质类型并不影响光照模型 而是在阴影色、高光强度、高光指数等差异化
    _ShadowRamp：以采样贴图的形式将光照衰减映射为阴影色
            将5种材质类型和冷色调变化 预计算为10个像素高度的渐变条
    _MetalMap：处理金属材质的漫反射 使金属有基于视角的阶梯式漫反射衰减

非金属漫反射：
    _NdotL_Ramp：基于固定衰减遮罩和NdotL的重映射 作为_ShadowRamp采样UV的X轴
    阴影色：采样得到阴影色和冷色调阴影色
        基于isInAnyShadow 提供全局光源强度或阴影色
    夜晚：基于isInNight 根据环境亮度应用冷色调阴影色

金属漫反射：
    _MetalMap：使用类似于MatCap的采样方式 获得基于视角的阶梯状漫反射衰减强度
        基于漫反射衰减强度差值金属漫反射的暗部颜色和亮部颜色
    阴影色：基于isInAnyShadow 提供全局光源强度或阴影色
    夜晚：基于环境亮度应用阴影色

非金属高光：
    不同材质类型给与高光的指数和高光亮度系数
    但是pow运算的结果并不直接作为高光亮度的系数 仅用于配合高光阀值判断范围
    所以非金属的高光相当于高光区域均匀增亮 _LightMap的XZ分别控制亮度和范围
    阴影色：不受阴影影响

金属高光：
    pow运算的结果和_LightMap的Z作为高光亮度的系数 _LightMap的X不参与(相当于1)
    阴影色：只受到 isInCoverShadow 影响

AlphaBloom：
    如果result的某个颜色通道值高于1 则判断为有Bloom效果
    归一化颜色值并保存Bloom强度在A通道

双面：
    可使用UV1实现单面模型双面显示

描边：
    主要是要做一个可自定义宽度的描边 将描边宽度信息写入顶点色
    卡通描边需要连续 要解决沿法线方向扩张带来的表面不连续问题
        顶点沿着观察空间坐标对应的矢量方向扩张 实现深度偏移
            深度偏移不会改变片元坐标 会影响片元的遮蔽关系
        顶点沿着观察空间XY平面投影方向扩张 基于深度值缩放
            远处物体的描边宽度系数更高 抵消透视带来的物体缩小的影响
        预处理模型法线解决法线不连续问题
    描边颜色跟随材质颜色